{"_path":"/features/spam-and-virus-checking","_dir":"features","_draft":false,"_partial":false,"_locale":"","title":"Spam & Virus Checking","description":"","position":3.2,"category":"Features","body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Postal can integrate with SpamAssassin and ClamAV to automatically scan incoming and outgoing messages that pass through mail servers."}]},{"type":"element","tag":"alert","props":{"type":"warning"},"children":[{"type":"text","value":"\nThis functionality is disabled by default.\n"}]},{"type":"element","tag":"h2","props":{"id":"setting-up-spamassassin"},"children":[{"type":"text","value":"Setting up SpamAssassin"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"By default, Postal will talk to SpamAssassin's "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"spamd"}]},{"type":"text","value":" using an TCP socket connection (port 783). You'll need to install SpamAssassin on your server and then enable it within Postal."}]},{"type":"element","tag":"h3","props":{"id":"installing-spamassassin"},"children":[{"type":"text","value":"Installing SpamAssassin"}]},{"type":"element","tag":"pre","props":{"code":"sudo apt install spamassassin\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"sudo apt install spamassassin\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Once you have installed this, you will need to open up "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/etc/default/spamassassin"}]},{"type":"text","value":" and change "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ENABLED"}]},{"type":"text","value":" to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":" and  "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"CRON"}]},{"type":"text","value":" to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"1"}]},{"type":"text","value":". Then you should restart SpamAssassin."}]},{"type":"element","tag":"pre","props":{"code":"sudo systemctl restart spamassassin\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"sudo systemctl restart spamassassin\n"}]}]},{"type":"element","tag":"h3","props":{"id":"enabling-in-postal"},"children":[{"type":"text","value":"Enabling in Postal"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"To enable spam checking, you'll need to add the following to your "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"postal.yml"}]},{"type":"text","value":" configuration file and restart. If you have installed SpamAssassin on a different host to your Postal installation you can change the host here but be sure to ensure that the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"spamd"}]},{"type":"text","value":" is listening on your external interfaces."}]},{"type":"element","tag":"pre","props":{"code":"spamd:\n  enabled: true\n  host: 127.0.0.1\n  port: 783\n","language":"yaml","meta":"","className":"language-yaml shiki shiki-themes material-theme-lighter material-theme material-theme-palenight","style":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"element","tag":"span","props":{"class":"line","line":1},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E53935;--shiki-default:#F07178;--shiki-dark:#F07178"},"children":[{"type":"text","value":"spamd"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF"},"children":[{"type":"text","value":":\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":2},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E53935;--shiki-default:#F07178;--shiki-dark:#F07178"},"children":[{"type":"text","value":"  enabled"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#FF5370;--shiki-default:#FF9CAC;--shiki-dark:#FF9CAC"},"children":[{"type":"text","value":" true\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":3},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E53935;--shiki-default:#F07178;--shiki-dark:#F07178"},"children":[{"type":"text","value":"  host"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#F76D47;--shiki-default:#F78C6C;--shiki-dark:#F78C6C"},"children":[{"type":"text","value":" 127.0.0.1\n"}]}]},{"type":"element","tag":"span","props":{"class":"line","line":4},"children":[{"type":"element","tag":"span","props":{"style":"--shiki-light:#E53935;--shiki-default:#F07178;--shiki-dark:#F07178"},"children":[{"type":"text","value":"  port"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#39ADB5;--shiki-default:#89DDFF;--shiki-dark:#89DDFF"},"children":[{"type":"text","value":":"}]},{"type":"element","tag":"span","props":{"style":"--shiki-light:#F76D47;--shiki-default:#F78C6C;--shiki-dark:#F78C6C"},"children":[{"type":"text","value":" 783\n"}]}]}]}]},{"type":"element","tag":"pre","props":{"code":"postal stop\npostal start\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"postal stop\npostal start\n"}]}]},{"type":"element","tag":"h3","props":{"id":"classifying-spam"},"children":[{"type":"text","value":"Classifying Spam"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The spam system is based on a numeric scoring system and different scores are assigned to different issues which may appear in a message. You can configure different thresholds which define when a message is treated as spam. We recommend starting at 5 and updating this once you've seen how your incoming messages are classified."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You have three options which can be configured on a per route basis which defines how spam messages are treated:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Mark"}]},{"type":"text","value":" - messages will be sent through to your endpoint but the spam information will be made available to you."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Quarantine"}]},{"type":"text","value":" - the message will placed into your hold queue and you'll need to release them if you wish them to be passed to your application. They will only remain here for 7 days,"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Fail"}]},{"type":"text","value":" - the message will be marked as failed and will only be recorded in your message history without being sent."}]}]},{"type":"element","tag":"style","props":{},"children":[{"type":"text","value":"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"setting-up-spamassassin","depth":2,"text":"Setting up SpamAssassin","children":[{"id":"installing-spamassassin","depth":3,"text":"Installing SpamAssassin"},{"id":"enabling-in-postal","depth":3,"text":"Enabling in Postal"},{"id":"classifying-spam","depth":3,"text":"Classifying Spam"}]}]}},"_type":"markdown","_id":"content:3.features:spam-and-virus-checking.md","_source":"content","_file":"3.features/spam-and-virus-checking.md","_extension":"md"}